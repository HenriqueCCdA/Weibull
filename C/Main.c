#include<stdio.h>
#include<omp.h>
#include<math.h>

void weibull(double const mu , double const sig
            ,double *b       , double *c
            ,double const tol, int const maxIt);

/*********************************************************************/
double media(double c, double b)
{
  return c*tgamma(1.e0 + 1.e0/b);
}
/*********************************************************************/

/*********************************************************************/
double desv(double c, double b)
{
  double mu = media(c, b);

  return sqrt( c*c*tgamma(1.e0 + 2.e0/b) - mu*mu);

}
/*********************************************************************/

/*********************************************************************/
int main(int argc, char *argv[]){

  double mu, sig, mui, sigi, b, c;
  double time;
/*...*/
  mu  = 99884.95e0;
  sig = 255.84e0;
/*...................................................................*/

/*...*/
  time = omp_get_wtime();
  weibull(mu ,sig
         ,&b ,&c
         ,1.e-11,15000000);
  time = omp_get_wtime() - time;
/*...................................................................*/

/*...*/
  printf("*********************************************************\n");
  printf("Time (s) = %.6lf\n", time);
  printf("*********************************************************\n");
/*...................................................................*/

/*...*/
  printf("*********************************************************\n");
  printf("c = %.6lf\n", c);
  printf("b = %.6lf\n", b);
  printf("*********************************************************\n");
/*...................................................................*/

/*...*/
  mui  = media( c, b);
  sigi = desv( c, b);
/*...................................................................*/

/*...*/
  printf("*********************************************************\n");
  printf("mu    = %.6lf\nmui   = %.6lf\n|res| = %e\n"
        , mu, mui, fabs( mu - mui ));
  printf("\n");
  printf("sig   = %.6lf\nsigi  = %.6lf\n|res| = %e\n"
        , sig, sigi, fabs( sig - sigi ));
  printf("*********************************************************\n");
/*...................................................................*/


}
/*********************************************************************/